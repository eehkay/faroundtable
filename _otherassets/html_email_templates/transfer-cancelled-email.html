<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transfer Cancelled - {{vehicle.year}} {{vehicle.make}} {{vehicle.model}}</title>
    <!--[if mso]>
    <noscript>
        <xml>
            <o:OfficeDocumentSettings>
                <o:PixelsPerInch>96</o:PixelsPerInch>
            </o:OfficeDocumentSettings>
        </xml>
    </noscript>
    <![endif]-->
    <style>
        /* Reset styles */
        body, table, td, a { -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; }
        table, td { mso-table-lspace: 0pt; mso-table-rspace: 0pt; }
        img { -ms-interpolation-mode: bicubic; }

        /* Remove default styling */
        img { border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; }
        table { border-collapse: collapse !important; }
        body { height: 100% !important; margin: 0 !important; padding: 0 !important; width: 100% !important; }

        /* Mobile styles */
        @media screen and (max-width: 600px) {
            .mobile-hide { display: none !important; }
            .mobile-center { text-align: center !important; }
            .container { padding: 0 10px !important; width: 100% !important; }
            .content-table { width: 100% !important; }
            .vehicle-image { width: 100% !important; height: auto !important; }
            .button { width: 100% !important; max-width: 300px !important; }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            .darkmode-bg { background-color: #0a0a0a !important; }
            .darkmode-text { color: #ffffff !important; }
        }
    </style>
</head>
<body style="margin: 0; padding: 0; background-color: #e5e7eb; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;">
    
    <!-- Wrapper -->
    <table border="0" cellpadding="0" cellspacing="0" width="100%" style="background-color: #e5e7eb;">
        <tr>
            <td align="center" style="padding: 40px 0; background-color: #e5e7eb;">
                
                <!-- Email Container -->
                <table class="container" border="0" cellpadding="0" cellspacing="0" width="600" style="background-color: #ffffff; border-radius: 12px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.05);">
                    
                    <!-- Header -->
                    <tr>
                        <td align="center" style="padding: 40px 20px; background-color: #0a0a0a; border-radius: 12px 12px 0 0;">
                            <img src="https://vchtbaawxxruwtvebxlg.supabase.co/storage/v1/object/public/logos//roundtable-logo-stacked.png" 
                                 alt="Roundtable" 
                                 width="150" 
                                 style="display: block; margin: 0 auto;">
                        </td>
                    </tr>
                    
                    <!-- Alert Banner -->
                    <tr>
                        <td style="background-color: #ef4444; color: #ffffff; padding: 20px; text-align: center;">
                            <h2 style="margin: 0; font-size: 20px; font-weight: 600;">
                                ❌ Transfer Cancelled
                            </h2>
                        </td>
                    </tr>
                    
                    <!-- Main Content -->
                    <tr>
                        <td style="padding: 40px 30px;">
                            
                            <!-- Greeting -->
                            <p style="font-size: 16px; color: #333333; margin: 0 0 20px 0;">
                                Hello {{user.name}},
                            </p>
                            
                            <p style="font-size: 16px; color: #333333; margin: 0 0 30px 0;">
                                The transfer request for the following vehicle has been cancelled.
                            </p>
                            
                            <!-- Vehicle Details Card -->
                            <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 30px;">
                                <tr>
                                    <td style="background-color: #f8f9fa; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px;">
                                        
                                        <!-- Vehicle Image -->
                                        {{#if vehicle.image_link1}}
                                        <div style="margin-bottom: 20px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.06);">
                                            <img src="{{vehicle.image_link1}}" 
                                                 alt="{{vehicle.year}} {{vehicle.make}} {{vehicle.model}}" 
                                                 class="vehicle-image"
                                                 style="width: 100%; max-width: 540px; height: auto; display: block;">
                                        </div>
                                        {{/if}}
                                        
                                        <!-- Vehicle Info -->
                                        <h3 style="margin: 0 0 15px 0; color: #0a0a0a; font-size: 22px;">
                                            {{vehicle.year}} {{vehicle.make}} {{vehicle.model}}
                                        </h3>
                                        
                                        <table border="0" cellpadding="0" cellspacing="0" width="100%">
                                            <tr>
                                                <td width="50%" style="padding: 5px 0;">
                                                    <strong style="color: #6b7280;">Stock #:</strong>
                                                    <span style="color: #333333;">{{vehicle.stock_number}}</span>
                                                </td>
                                                <td width="50%" style="padding: 5px 0;">
                                                    <strong style="color: #6b7280;">VIN:</strong>
                                                    <span style="color: #333333; font-size: 14px;">{{vehicle.vin}}</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="50%" style="padding: 5px 0;">
                                                    <strong style="color: #6b7280;">Price:</strong>
                                                    <span style="color: #333333; font-weight: 600;">{{vehicle.price}}</span>
                                                </td>
                                                <td width="50%" style="padding: 5px 0;">
                                                    <strong style="color: #6b7280;">Mileage:</strong>
                                                    <span style="color: #333333;">{{vehicle.mileage}} miles</span>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                            
                            <!-- Cancellation Details -->
                            <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 30px;">
                                <tr>
                                    <td style="border-left: 4px solid #ef4444; padding-left: 20px;">
                                        <h4 style="margin: 0 0 15px 0; color: #0a0a0a; font-size: 18px;">
                                            Cancellation Details
                                        </h4>
                                        
                                        <table border="0" cellpadding="5" cellspacing="0">
                                            <tr>
                                                <td style="color: #6b7280; padding-right: 15px;">Original Request:</td>
                                                <td style="color: #333333;">{{transfer.from_location.name}} → {{transfer.to_location.name}}</td>
                                            </tr>
                                            <tr>
                                                <td style="color: #6b7280; padding-right: 15px;">Requested by:</td>
                                                <td style="color: #333333;">{{transfer.requested_by.name}}</td>
                                            </tr>
                                            <tr>
                                                <td style="color: #6b7280; padding-right: 15px;">Cancelled Date:</td>
                                                <td style="color: #333333;">{{system.date}}</td>
                                            </tr>
                                            <tr>
                                                <td style="color: #6b7280; padding-right: 15px;">Status:</td>
                                                <td>
                                                    <span style="background-color: #fee2e2; color: #b91c1c; padding: 3px 10px; border-radius: 4px; font-size: 12px; font-weight: 600; text-transform: uppercase;">
                                                        CANCELLED
                                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                        
                                        {{#if transfer.cancellation_reason}}
                                        <div style="margin-top: 15px; padding: 15px; background-color: #fef2f2; border-radius: 6px;">
                                            <strong style="color: #991b1b;">Cancellation Reason:</strong>
                                            <p style="margin: 5px 0 0 0; color: #991b1b;">{{transfer.cancellation_reason}}</p>
                                        </div>
                                        {{/if}}
                                    </td>
                                </tr>
                            </table>
                            
                            <!-- What This Means Section -->
                            <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 30px;">
                                <tr>
                                    <td style="background-color: #f3f4f6; border-radius: 8px; padding: 20px;">
                                        <h4 style="margin: 0 0 10px 0; color: #374151; font-size: 16px;">
                                            ℹ️ What this means
                                        </h4>
                                        <ul style="margin: 0; padding-left: 20px; color: #374151;">
                                            <li style="margin-bottom: 8px;">The vehicle will remain at its current location</li>
                                            <li style="margin-bottom: 8px;">No transportation arrangements are needed</li>
                                            <li style="margin-bottom: 8px;">The vehicle is available for other transfer requests</li>
                                            <li style="margin: 0;">All parties have been notified of this cancellation</li>
                                        </ul>
                                    </td>
                                </tr>
                            </table>
                            
                            <!-- Action Button -->
                            <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 30px;">
                                <tr>
                                    <td align="center">
                                        <a href="{{link.dashboard}}" 
                                           style="display: inline-block; padding: 16px 40px; background-color: #3b82f6; color: #ffffff; text-decoration: none; border-radius: 6px; font-weight: 600; font-size: 16px;">
                                            View Dashboard
                                        </a>
                                    </td>
                                </tr>
                            </table>
                            
                            <!-- Additional Info -->
                            <p style="font-size: 14px; color: #6b7280; margin: 0 0 10px 0; text-align: center;">
                                If you have questions about this cancellation, please contact the requesting party.
                            </p>
                            
                        </td>
                    </tr>
                    
                    <!-- Footer -->
                    <tr>
                        <td style="background-color: #f8f9fa; padding: 30px; text-align: center; border-radius: 0 0 12px 12px; border-top: 1px solid #e5e7eb;">
                            <p style="margin: 0 0 10px 0; color: #6b7280; font-size: 14px;">
                                <a href="{{link.dashboard}}" style="color: #3b82f6; text-decoration: none;">Go to Dashboard</a>
                            </p>
                            <p style="margin: 0; color: #9ca3af; font-size: 12px;">
                                © {{system.date}} Round Table. All rights reserved.
                            </p>
                        </td>
                    </tr>
                    
                </table>
                <!-- End Email Container -->
                
            </td>
        </tr>
    </table>
    <!-- End Wrapper -->
    
</body>
</html>